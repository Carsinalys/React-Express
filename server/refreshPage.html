<!doctype html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Refresh password page</title>
    <style>
        .main {
            min-height: 100vh;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #cccccc;
        }
        .cover {
            width: 70%;
        }
    </style>
</head>
<body>
    <main class="main">
        <div class="cover">
            <form action="#" id="refresh">
                <input type="password" form="refresh" id="password_1" placeholder="enter new password">
                <input type="password" form="refresh" id="password_2" placeholder="repeat password">
                <button type="submit" form="refresh" data-id="replace" id="submit">send</button>
            </form>
        </div>
    </main>
    <script>
        let pass1 = document.querySelector('#password_1'),
            pass2 = document.querySelector('#password_2'),
            submit = document.querySelector('#submit');
        submit.addEventListener('click', (event)=>{
            event.preventDefault();
            const newRegexp = new RegExp(/^(?=.*d)(?=.*[a-z])(?=.*[A-Z])[0-9a-zA-Z]{8,}$/g);
            if (pass1.value === pass2.value && pass1.value.match(newRegexp)) {
                let data = {
                    password: pass1.value,
                    id: submit.dataset.id
                };
                fetch("http://cardinalys-w3u7.localhost.run/api/v1.0/confirmRefresh", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(data)
                }).then(res=>{
                    console.log(res);
                    document.location= res.url
                }).catch(error=>console.log(error))
            } else {
                alert('password don\'t match or length less than 8 letters')
            }
        })
    </script>
</body>
</html>